# Методические указания 
# по выполнению курсового проекта по дисциплине ПОСРВ

## Реализация, оформление исходного кода на языке C++

### 1. Введение
#### 1.1.
  Систематическое необоснованное нарушение правил оформления исходного кода является признаком низкой квалификации разработчика.
#### 1.2.
  Правила не являются панацеей от написания плохого кода.
###  2. Организация проекта
#### 2.1.
  В общем случае заголовочный файл должен содержать объявление одного класса. Возможно объявление нескольких вспомогательных классов, например, предикатов. Вспомогательные классы, как правило, элементарны и имеют гораздо меньший размер, чем основные. 
  
*требование*
#### 2.2.
  Файл .cpp должен совпадать по имени с заголовочным файлом и содержать определение объявленных в .h классов. 
  
*требование*
#### 2.3.
  Существует два основных подхода к включению заголовочных файлов:
Вариант 1: Все заголовочные файлы включаются в один (например, StdAfx.h), и этот заголовочный файл впоследствии используется.
Вариант 2: Заголовочные файлы включаются там, где они нужны, все, которые нужны.
Следует придерживаться варианта 2
  
*требование*
#### 2.4.
  Максимальный размер файла - 1000 строк.
  
*рекомендация*
#### 2.5.
  Структура каталогов проекта должна быть построена по следующему принципу: файлы каждого модуля должны быть разбиты на следующие папки: 
* src – файлы .cpp
* h – файлы .h
* res – файлы ресурсов
* bin – исполняемые файлы, файлы библиотек и т.п.
Весь проект представляет собой большой модуль. Так что эта структура применима и к самому проекту.
  
*требование*
#### 2.6.
  Все пути, указанные в проекте (Include path, Output Path, …) должны быть относительными.
  
*требование*
#### 2.7.
  Используйте кодировку utf-8
  
*требование*
#### 2.8.
  В качестве отступов используйте 4 пробела, не табуляцию.
  
*требование*

###  3.  Внутренняя структура файлов
  
#### 3.1.
  Заголовочные файлы необходимо защищать от повторного включения
с помощью следующей конструкции:
```c++
  #ifndef ИМЯ_ФАЙЛА_РАСШИРЕНИЕ
  #define ИМЯ_ФАЙЛА_РАСШИРЕНИЕ
  //здесь какой-то код
  #endif  //ИМЯ_ФАЙЛА_РАСШИРЕНИЕ
```

  
*требование*
#### 3.2.
  Максимальная длина строки в файле - 100 символов. В случае переноса строки используйте вертикальное выравнивание со сдвигом. 
  
*требование*
#### 3.3.
  Все включаемые директивой #include файлы должны находиться в начале файла 
  
*требование*
#### 3.4.
  Включаемые файлы должны быть отсортированы и сгруппированы. Сортировка производится от низкоуровневых к высокоуровневым файлам. Для группировки используется одна или несколько пустых строк. Например:
```c++
#include <fstream>
#include <iomanip>


#include <XML/DOM.h>
#include <XML/Node.h>


#include "UI/PropertiesDialog.h"
#include "UI/MainWindow.h"
```


  
*рекомендация*
###  4.  Именование
  

#### 4.1.
  Имя файла должно быть осмысленным и отражать его назначение
  
*требование*
#### 4.2.
  Для формирования идентификаторов используется английский язык с корректным написанием слов
  
*требование*
#### 4.3.
  Использование собственных аббревиатур в идентификаторах и сокращений сводится к минимуму. Использование общепринятых аббревиатур допускается
  
*требование*
#### 4.4.
  Использование зарезервированных различными международными стандартами идентификаторов (см. прил. 1) не допускается
  
*требование*
#### 4.5.
  Избегайте именования локальных объектов таким образом, что они перекрывают внешние имена
  
*требование*
#### 4.6.
  Избегайте имен, незначительно отличающихся друг от друга и имен, использующих похожие символы, такие как '0', '1' и 'O', 'l'.
  
*требование*
#### 4.7.
  Имена локальных переменных должны быть короткими и понятными. Не стоит назвать переменную ThisVariableIsATemporaryCounter, когда можно просто писать tmp, что не менее понятно. Переменную счетчика цикла стоит назвать i, а не loop_counter
  
*требование*
#### 4.8.
  Использование префиксов в названиях переменных необязательно. При использовании префиксов они должны соответствовать прил. 2.
  
*требование*
#### 4.9.
  Название всех идентификаторов должно быть осмысленным
  
*требование*
  #### 4.10.
  При именовании классов и их методов старайтесь выбирать имена таким образом, чтобы вызов вида:
`myObject.method()` читался как имеющая смысл фраза
  
*рекомендация*
  #### 4.11.
  Каждое слово, входящее в состав идентификатора, кроме первого, пишется с заглавной буквы. Слова пишутся слитно, например:
helloWorld
Классы именуются с заглавной буквы, объекты классов, методы и атрибуты — со строчной буквы. Имена макросов состоят из заглавных букв.
  
*рекомендация*
  #### 4.12.
  Использование символа `_` для разделения слов в идентификаторах не допускается
  
*требование*
  #### 4.13.
  Имя функции должно содержать ключевое слово – глагол, имя класса – существительное.
  
*требование*
###  5.  Классы

#### 5.1.
  Перегруженные функции должны выполнять похожую работу. Если функции делают разные вещи, они должны иметь разные имена
  
*требование*
#### 5.2.
  Все члены-данные класса должны быть проинициализированы в конструкторе
  
*требование*
#### 5.3.
  Для каждого класса должны быть объявлены:
* деструктор (должен быть виртуальным),
* конструктор по умолчанию,
* оператор присваивания,
* конструктор копий.
  
*рекомендация*
#### 5.4.
  Не используйте публичные члены-данные. Избегайте защищенных. Исключение составляют структуры, не имеющие методов вообще
  
*рекомендация*
#### 5.5.
  Не следует использовать "атрибут типа", т.е. атрибут класса, определяющий его поведение. Используйте виртуальные функции и наследование
  
*рекомендация*

### 6.  Функции и методы
  

#### 6.1.
  Процедура должна умещаться на двух экранах кода (не более 50 строк). Рекомендуется ограничиваться 25-ю строками.
  
*требование*
#### 6.2.
  Максимально ограничивайте область видимости функции. 
  
*рекомендация*
#### 6.3.
  Главное правило: Функция должна быть короткой и делать ровно одно дело и делать его хорошо.
  
*рекомендация*
#### 6.4.
  В общем случае избегайте создания многоцелевых процедур, которые выполняют набор несвязанных между собой действий.
  
*рекомендация*
#### 6.5.
  Используйте функцию для одной и только одной цели. 
  
*рекомендация*
#### 6.6.
  Краткое описание функциям следует писать ДО написания кода
  
*рекомендация*

###  7.  Переменные
  

#### 7.1.
  Переменная должна объявляться как можно ближе к месту, где она будет впервые использована.
  
*требование*
#### 7.2.
  Не забывайте инициализировать переменные при объявлении.
  
*требование*
#### 7.3.
  В качестве счетчиков циклов допускаются локальные однобуквенные переменные. Предпочитайте именовать их в такой последовательности: i, j, k, m, n
  
*требование*
#### 7.4.
  Максимально ограничивайте область видимости переменной. Не используйте глобальные переменные. 
Избегайте именования локальных объектов таким образом, что они перекрывают внешние имена
  
*рекомендация*
#### 7.5.
  Введение в программу глобальной переменной очень ответственная операция, необходимость которой должна быть четко обоснована. Идентификатор глобальной переменной должен четко сообщать о том, для чего она предназначена.
Перед описанием переменной должен быть комментарий, говорящий о том, что эта переменная содержит и какими частями программы используется. В случае если возникает необходимость работы с переменной из нескольких потоков необходимо обязательно написать в комментарии, какие механизмы применяются для блокировки данной переменной.
Вообще глобальные переменные надо вводить в программу с большой осторожностью, только в том случае, если нельзя без них обойтись или в случае, если решение проблемы другим путем сильно скажется на производительности. 
  
*требование*
#### 7.6.
  Используйте переменную для одной и только одной цели. Если временная переменная используется для двух разных целей, заведите две временные переменные
  
*рекомендация*
  

### 8. Синтаксис
  

#### 8.1.
  Выражения должны быть как можно более простыми и понятными. Помните, что код читают люди разной квалификации. Старайтесь облегчить им работу
  
*требование*
#### 8.2.
  Следует придерживаться следующего правила расстановки {}:
```c++
  while (condition)
  {
    ...
  }


  if (condition)
  {
    ...
  }
  else
  {
    ...
  }
```

  
*требование*
#### 8.3.
  Перенос длинных строк должен осуществляться после , ; и других операторов
  
*рекомендация*
#### 8.4.
  Операторы сравнения должны быть окружены пробелами
```c++
if (a <= b)
```

  
*рекомендация*
#### 8.5.
  Символы математических операций должны быть окружены пробелами
  
*рекомендация*
###  9. Использование средств языка программирования и среды разработки

#### 9.1.
  Следует избегать использования оператора `goto` во всех случаях
  
*требование*
#### 9.2.
  Следует избегать макросов, за исключением include guards (см. п. 3.1)
  
*рекомендация*
#### 9.3.
  Следует избегать абсолютных путей (вроде "c:\\temp") во всех случаях
  
*требование*
#### 9.4.
  Избегайте присваиваний в операторах сравнения 
  
*рекомендация*
#### 9.5.
  Установите максимальный уровень выдачи предупреждений компилятором. Добивайтесь компиляции без единого предупреждения. 
  
*рекомендация*
#### 9.6.
  Используйте тип `bool` для хранения значений истина/ложь.
  
*рекомендация*
#### 9.7.
  Используйте STL и шаблоны взамен контейнерных классов среды разработки там, где это возможно.
  
*требование*
#### 9.8.
  Используйте `std::string`, вместо строковых типов среды разработки или массивов char.
  
*рекомендация*
#### 9.9.
  Не используйте "магические цифры". Кто через год вспомнит, почему здесь стоит 30.67? Используйте константы.
  
*требование*
#### 9.10.
  Как можно меньше используйте системно-зависимые и FRAMEWORK-зависимые
  решения, чтобы написанный Вами код можно было использовать на разных платформах или
  хотя бы с разными компиляторами (портируемый код).
  
*рекомендация*
#### 9.11.
  При необходимости создать бесконечный цикл используйте for:
```c++
for(;;) 
{
  ...;
}
```
либо
```c++
while(true) 
{
  ...;
}
```
  
*требование*
### 10. Комментирование кода

#### 10.1.
  Каждый файл имеет комментарий, размещаемый в самом начале файла, за которым идет все остальное.
  
*требование*
#### 10.2.
  Комментарии учитывают требования системы генерации документации по исходному тексту doxygen (см. прил. 3)
  
*рекомендация*
#### 10.3.
  Каждый тип данных пользователя (класс, структура, объединение и т.п.), а также каждый элемент класса структуры и т. п. должен быть снабжен комментарием, например:
```c++
//! The SMyOwnClass is created for the special purpose
//! And should be used everywhere it is possible
//! With no obligation to send a post card
class SMyOwnClass
{
    . . .
};
```
  
*требование*
#### 10.4.
  Каждая функция (метод класса) должна быть снабжена комментарием (см. П3.4)
  
*требование*
#### 10.5.
  После того как код написан или изменен, не забудьте просмотреть комментарии к измененной функции или классу и при необходимости обновить их. При изменении функций (методов) следует просматривать комментарии «снизу вверх» - комментарий к самой функции, к вызывающим ее функциям, комментарий к ее классу
  
*требование*
#### 10.6.
  Каждая переменная должна быть прокомментирована. В комментарии указывают назначение переменной и особенности ее использования.
  
*требование*
  
## Приложение 1. Список зарезервированных стандартами идентификаторов


Зарезервированные идентификаторы    | Стандарт
---                                 | ---
Двойное подчеркивание в любом месте | ISO C++, ANSI C
Одиночное подчеркивание в начале    | ISO C++, ANSI C
E[0-9A-Z]:                          | ANSI C
is[a-z]:                            | ANSI C
to[a-z]:                            | ANSI C
LC_:                                | ANSI C
SIG[_A-Z}:                          | ANSI C
str[a-z]:                           | ANSI C
mem[a-z]                            | ANSI C
wcs[a-z]:                           | ANSI C
:_t                                 | ANSI C

### Приложение 2. Префиксы типизированных переменных


Префикс | Тип
---     | ---
с       | char, CHAR
uc      | unsigned char, BYTE
b       | bool, BOOL
w       | unsigned short, WORD
dw      | unsigned long, DWORD
n       | int, INT
u       | unsigned int, UINT
s       | char*, CHAR*, PCHAR
sz      | char*, CHAR*, PCHAR (если строка заканчивается символом \0)
p       | void*, VOID*, PVOID
p       | unsigned char*, BYTE*, PBYTE
pn      | unsigned int*, INT*, UINT*, PINT
pdw     | unsigned long*, DWORD*, PDWORD
  

#### Объекты Borland VCL

Сокращение | Полное название
---        | ---
form       | Forms
fra        | Frames
mi         | MenuItem
pop        | PopupMenu
lbl        | Label
edt        | Edit
mm         | Memo
btn        | Button, BitButton, SpeedButton
chk        | CheckBox
rb         | RadioButton
list       | ListBox
cb         | ComboBox
gb         | GroupBox
pnl        | Panel
btn        | Button, BitButton, SpeedButton
sg         | StringGrid
img        | Image
chklist    | CheckListBox
pc         | PageControl
imgl       | ImageList
rich       | RichEdit
tv         | TreeView
lv         | ListView
status     | StatusBar
tool       | ToolBar

### Приложение 3. Правила оформления комментариев для системы Doxygen


#### 3.1. Тэги которыми желательно пользоваться при оформлении комментариев

Тэг      | Описание
---      | ---
\file    | обозначает начало файла. Может содержать имя файла;
\brief   | краткое описание. Эквивалентно ‘///’;
\author  | автор;
\version | версия файла;
\date    | дата последнего обновления;
\par     | название нового параграфа;
\n       | переход на новую строку;
\fn      | функция (содержит имя функции с параметрами);
\param   | параметр функции (следующие слово за тэгом будет выделено);
\return  | возвращаемое значение;
\note    | описание функции (заметки);
\remarks | примечания, особенности реализации;
\code    | начало блока комментариев, которое выведется фиксированным шрифтом (блок должен заканчиваться тэгом \endcode).

Комментарии для подробного описания с использованием тэгов, должны быть следующего вида:

```c++
/**   
    текст
*/
```

или 

```c++
/*! 
    текст
*/
```
Для краткого описания используется следующий формат:
```c++
/// текст
```

#### Пример:
```c++
/*______________________________ MultPort.cc ________________________________ */
/**
    \file       Multport.cc
    \brief      Реализация мультиплексирующего класса на различные типы пакетов.
    \author     Горбачевский К.С.
    \version    1.2
    \date       10.11.2004
    \note       Класс реализует информационный обмен по протоколу межмодульного
                обмена. Поддерживаются как передача данных в соответствующий
                канал, так и передача команд.
    \remarks    Необходимо создать экземпляр класса, а затем в потоке вызвать
                функцию Create() для инициализации внутренних полей класса.
    \par        История создания:
    \code   
        1/10/2002 – 1.0 – работа по опросу;
        5/05/2003 – 1.1 – используются прерывания для приема и передачи данных;
        7/02/2004 – 1.2 – реализован класс для предоставления сервиса
                          межмодульного взаимодействия.
    \endcode
      
*/
```


#### 3.2. Маркировкa комментариев
Используется комбинация символов `//!`, `/*! . . . */` и `//!<`.
Последний означает, что комментарий относится к предшествующему элементу.
Кроме того, используются комбинации `@param` для описания параметров функций и методов и
`@return` для описания возвращаемых значений.
Комментарии даются на корректном русском языке 
Размер комментария пропорционален сложности комментируемого объекта 
Предпочтительный формат комментария в стиле C++: // 
Комментарии, предшествующие комментируемому элементу, располагаются с отступом 2 пробела 
```c++
  //! This is the remark
bool    SomeBooleanValue;
```


```c++
  //! This is the first line
  //! More detailed description
bool    SomeBooleanValue;
```
  

#### 3.3. Комментарии
  находящиеся в той же строке, что и комментируемый элемент.
Комментарии могут даваться разными способами: предшествующие комментируемому элементу,
  Комментарий, находящийся в той же строке должен быть отделен не менее чем двумя пробелами
  от комментируемого элемента. 
```c++
    //! This is the first type of the remark
bool    SomeBooleanValue;
```

```c++
bool    SomeBooleanValue;    //!< Many lines remark
                             //!< Second line of the remark
```
  

#### 3.4. Описание функций
1. Краткое описание (назначение)
2. Описание параметров, возможные значения, признак входных/выходных параметров ( признак входных/выходных параметров указывается после ‘–’ в скобках: (in) или (out))
3. Возвращаемое значение
4. Комментарии (подробное описание работы функции)
```c++
    //! The function transforms string representation into integer
    //! @param InputValue is a stringed value
    //! @param Base is a scale of notation
    //! @return transformed value of the given scale of notation
long SuperFunction ( const string &  InputValue, long  Base );
  /**
      \fn         void * SpsThreadWrite( void * p )
      \brief      Поток отложенной записи.
      \param      P – указатель на структуру THR_WRITE_PARAMS.
      \return     Указатель на данные.
      \note       Поток инициализирует переменные, ...
      \remarks    Функция не проверяет указатель на NULL.    
*/
void * SpsThreadWrite( void * p )
{
} // SpsThreadWrite
```

### Приложение 4. Инструкции по настройке проекта в C++ Builder


Для создания проекта визуального приложения в C++ Builder используйте пункт меню New –> VCL Forms Application.


Для выбора конфигурации проекта (Debug/Release) вызовите окно Project –> Build Configurations. В поле Available projects выберите свой проект и нажмите Edit. В появившемся окне выберите нужную конфигурацию и нажмите Activate, OK, Close.


Настройка параметров проекта выполняется после создания (загрузки) проекта в меню Project –>Options.


Параметр
  Значение
  C++ Compiler
  

  

  Paths and Defines
  

  

  

  Include search path
  Директория расположения h-файлов проекта
  

  Output Settings
  

  

  

  Specify output directory for object files
  Директория расположения obj-файлов (не должна совпадать с директорией проекта, exe-файла или другими)
  

  Compiling
  

  

  

  Enums always integer sized
  Включено
  

  Data Alignment
  

  

  

  Data Alignment
  4 byte
  

  Precompiled headers
  

  

  

  Generate and use precompiled headers
  Выключено
  

  Source
  

  

  

  Enable nested comments
  Включено
  

  

  MS VC++ compatibility
  Включено
  Linker
  

  

  Paths and Defines
  

  

  

  Library search path
  Директория расположения используемых при компиляции дополнительных библиотек lib (если используются)
  

  Output settings
  

  

  

  Final output directory
  Директория  расположения  результатов сборки проекта (exe-файла)
  

  Linking
  

  

  

  Use dynamic RTL
  Выключено
  Forms
  

  

  

  Main form
  Форма, жизненный цикл которой совпадает с жизненным циклом программы
  

  

  Auto-create forms
  Список форм приложения, которые будут автоматически создаваться при запуске программы
  

  

  Available forms
  Список форм приложения, которые не будут автоматически создаваться при запуске программы, их программист создает динамически
  Application
  

  

  

  Title
  Название программы, отображаемое в панели задач и при переключении задач
  

  

  Icon
  Иконка программы, отображаемая в панели задач и при переключении задач
  Version Info
  

  

  

  Include version information info
  Включено (если есть необходимость включить информацию о версии программы в exe-файл)
  

  

  (см. окно Version Info)
  

  Packages
  

  

  

  Build with runtime packages
  Выключено
